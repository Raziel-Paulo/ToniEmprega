@* Views/Ofertas/Index.cshtml *@
@model IEnumerable<ToniEmprega.Models.Oferta>
@{
    ViewData["Title"] = "Ofertas de Emprego";
    var tipos = ViewBag.TiposOferta as List<TipoOferta>;
}

<div class="card" style="margin-bottom: 2rem;">
    <div class="card-header">
        <h2 class="card-title"><i class="fas fa-search"></i> Pesquisar Ofertas</h2>
    </div>

    <form method="get" class="search-box">
        <div class="search-input">
            <input type="text" name="searchString" class="form-control" placeholder="Pesquisar por título ou descrição..."
                   value="@Context.Request.Query["searchString"]" />
        </div>

        <select name="tipoOfertaId" class="form-control" style="width: auto;">
            <option value="">Todos os Tipos</option>
            @foreach (var tipo in tipos)
            {
                <option value="@tipo.Id" selected="@(Context.Request.Query["tipoOfertaId"] == tipo.Id.ToString())">
                    @tipo.Designacao
                </option>
            }
        </select>

        <button type="submit" class="btn btn-primary">
            <i class="fas fa-search"></i> Filtrar
        </button>

        <a href="/Ofertas" class="btn btn-outline">
            <i class="fas fa-times"></i> Limpar
        </a>
    </form>
</div>

<h2 style="color: var(--color-blue); margin-bottom: 1.5rem;">
    <i class="fas fa-briefcase"></i> Ofertas Disponíveis
    <span style="color: var(--color-gray); font-size: 1rem;">(@Model.Count() resultados)</span>
</h2>

<div class="ofertas-grid">
    @foreach (var oferta in Model)
    {
        <div class="oferta-card">
            <div class="oferta-header">
                <span class="oferta-tipo">@oferta.TipoOferta?.Designacao</span>
                <span style="color: var(--color-gray); font-size: 0.85rem;">
                    <i class="fas fa-clock"></i> @oferta.Data_Publicacao.ToString("dd/MM/yyyy")
                </span>
            </div>
            <h3 class="oferta-titulo">@oferta.Titulo</h3>
            <div class="oferta-empresa">
                <i class="fas fa-building"></i> @oferta.Empresa?.Nome_Empresa
            </div>
            <p class="oferta-descricao">
                @(oferta.Descricao?.Length > 150 ? oferta.Descricao.Substring(0, 150) + "..." : oferta.Descricao)
            </p>
            <div style="margin-bottom: 1rem;">
                <small style="color: var(--color-gray);">
                    <i class="fas fa-list-check"></i> @oferta.Requisitos
                </small>
            </div>
            <div class="oferta-footer">
                <span class="oferta-localizacao">
                    <i class="fas fa-map-marker-alt"></i> @oferta.Localizacao
                </span>
                <a href="/Ofertas/Details/@oferta.Id" class="btn btn-primary">
                    Ver Detalhes
                </a>
            </div>
        </div>
    }
</div>

@if (!Model.Any())
{
    <div style="text-align: center; padding: 3rem; color: var(--color-gray);">
        <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 1rem;"></i>
        <h3>Nenhuma oferta encontrada</h3>
        <p>Tente ajustar os filtros de pesquisa.</p>
    </div>
}